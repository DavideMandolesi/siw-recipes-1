<!DOCTYPE html>
<html lang="it">

<head>
	<meta charset="UTF-8" />
	<title>SiwRecipes - Amministrazione</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<!-- Icone -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
	<!-- CSS Globale (Tema) -->
	<link rel="stylesheet" th:href="@{/theme.css}">
	<!-- CSS Specifico (Layout) -->
	<link rel="stylesheet" th:href="@{/adminScreen.css}">
</head>


<body>
	<div class="app-container">

		<!-- SIDEBAR -->
		<aside class="sidebar">
			<div class="brand">
				<div class="logo-icon"><i class="fa-solid fa-bread-slice"></i></div>
				<h1>SiwRecipes</h1>
			</div>

			<nav class="sidebar-menu">
				<div class="menu-section">
					<span class="menu-label">MENU PRINCIPALE</span>
					<ul>
						<li class="active"><a href="#"><i class="fa-solid fa-house"></i> Esplora Ricette</a></li>

						<!--Visibile SEMPRE, accessibile SOLO SE AUTENTICATO (vedi auth config)-->
						<li><a href="#"><i class="fa-solid fa-book-open"></i> Le Mie Ricette</a></li>
						<!--<li><a href="#"><i class="fa-regular fa-heart"></i> Preferiti</a></li>-->
						<li><a href="#"><i class="fa-regular fa-comment"></i> Le Mie Recensioni</a></li>
					</ul>
				</div>

				<!-- Mostra SOLO se autenticato come AMMINISTRATORE-->
				<div class="menu-section" th:if="${isAdmin}">
					<span class="menu-label">AMMINISTRAZIONE</span>
					<ul>
						<li><a th:href="@{/admin/categoryPanel}"><i class="fa-solid fa-shield-halved"></i> Gestisci
								Categorie</a></li>
						<li><a href="#"><i class="fa-solid fa-users"></i> Gestione Utenti</a></li>
					</ul>
				</div>
			</nav>

			<div class="user-profile">
				<a href="/profile"><img th:src="${currentUser?.urlImage} ?: ${defaultProfileUrlImage}"
						class="user-avatar-sb"></a>
				<div class="user-info">
					<a href="/profile"><span class="user-name" th:text="${currentUser?.firstName} ?: 'Accedi'"
							}></span></a>
					<a href="/profile" class="user-role" th:if="${isAdmin}">Admin</a>
					<a href="/profile" class="user-role" th:unless="${isAdmin}">Visualizza profilo</a>
				</div>

				<a href="/logout" class="logout-btn"><i class="fa-solid fa-arrow-right-from-bracket"></i></a>
			</div>
		</aside>



		<!-- MAIN CONTENT -->
		<main class="main-content">

			<header class="admin-header">
				<h2 class="page-title">Gestione Categorie</h2>
				<div class="admin-meta">
					<span class="admin-badge"><i class="fa-regular fa-circle-check"></i> Admin Mode</span>
				</div>
			</header>

			<!-- Admin Grid Layout -->
			<div class="admin-grid">

				<!-- Colonna Sinistra: Lista Categorie -->
				<section class="admin-list-section">
					<div class="list-header">
						<h3 th:text="'Elenco Categorie (' + ${#lists.size(categoryList)} + ')'">Elenco Categorie (0)</h3>
					</div>

					<div class="admin-table-container">
						<table class="admin-table">
							<thead>
								<tr>
									<th width="25%">Nome Categoria</th>
									<th width="55%">Descrizione</th>
									<th width="20%" style="text-align: right;">Azioni</th>
								</tr>
							</thead>
							<tbody>
								<!-- Riga 1 -->
								<tr th:each="c : ${categoryList}">
									<td class="col-primary" th:text="${c.name}">Primi Piatti</td>
									<td th:text="${c.description}">Pasta, risotti, zuppe e minestre della tradizione.</td>
									<td>
										<div class="action-buttons">
											<a th:href="@{/admin/editCategory/{id}(id=${c.id})}"><button class="btn-icon btn-edit" title="Modifica">
												<i class="fa-solid fa-pen"></i>
											</button></a>
											<a th:href="@{/admin/deleteCategory/{id}(id=${c.id})}"><button class="btn-icon btn-delete" title="Elimina">
												<i class="fa-regular fa-trash-can"></i>
											</button></a>
										</div>
									</td>
								</tr>
								
							</tbody>
						</table>
					</div>
				</section>

				<!-- Colonna Destra: Form Aggiunta -->
				<section class="admin-form-section">
					<div class="form-card">
						<h3>Aggiungi Categoria</h3>
						
						<!-- AGGIUNGI CHECK ERRORI PER INSERIMENTO NUOVA CATGORIA (come cat giÃ  esistente) -->
						
						<p class="form-desc">Inserisci i dettagli per creare una nuova classificazione.</p>

						<form th:action="@{/admin/confirmNewCategory}" method="POST" th:object="${category}">
							<label class="label">Nome Categoria</label>
							<input type="text" class="admin-input" placeholder="Es. Antipasti" required th:field="${category.name}">

							<label class="label">Descrizione</label>
							<textarea class="admin-input admin-textarea"
								placeholder="Breve descrizione della categoria..." name="description"required th:field="${category.description}"></textarea>

							<button type="submit" class="btn btn-primary" style="width: 100%;">
								<i class="fa-solid fa-plus"></i> Crea Categoria
							</button>
						</form>
					</div>
				</section>

			</div>

		</main>
	</div>
</body>